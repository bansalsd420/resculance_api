#!/bin/bash
# Quick Reference - Common Commands

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘           Resculance API - Quick Reference                     â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ“¦ DATABASE SETUP"
echo "  make db-setup-ci          â†’ Complete setup (reset + migrate + seed)"
echo "  npm run db:setup:ci       â†’ Same as above (npm version)"
echo "  npm run db:reset          â†’ Reset database only"
echo "  npm run db:migrate        â†’ Run migrations only"
echo "  npm run db:seed           â†’ Seed data only"
echo ""
echo "ğŸš€ SERVER"
echo "  npm run dev               â†’ Start in development mode"
echo "  npm start                 â†’ Start in production mode"
echo "  node src/server.js &      â†’ Start in background"
echo "  pkill -f 'node.*server'   â†’ Stop server"
echo "  lsof -i :5000             â†’ Check if port 5000 is in use"
echo ""
echo "ğŸ§ª TESTING"
echo "  ./test-rbac.sh            â†’ Run RBAC tests (12 tests)"
echo "  ./verify-data.sh          â†’ Verify data visibility"
echo "  ./test-apis.sh            â†’ Test all API endpoints"
echo ""
echo "ğŸ” TEST ACCOUNTS"
echo "  Superadmin:    superadmin@resculance.com / Super@123"
echo "  AIIMS Admin:   admin@aiims.delhi / Admin@123"
echo "  FastAid Admin: admin@fastaid.com / Admin@123"
echo ""
echo "ğŸ“¡ API ENDPOINTS"
echo "  Base URL: http://localhost:5000/api/v1"
echo ""
echo "  Auth:"
echo "    POST   /auth/login              â†’ Login (returns accessToken)"
echo "    POST   /auth/register           â†’ Register new user"
echo "    POST   /auth/refresh-token      â†’ Refresh access token"
echo ""
echo "  Users (RBAC):"
echo "    GET    /users                   â†’ List users (filtered by role)"
echo "    GET    /users/:id               â†’ Get user details"
echo "    POST   /users                   â†’ Create user"
echo "    PUT    /users/:id               â†’ Update user"
echo ""
echo "  Ambulances (RBAC):"
echo "    GET    /ambulances              â†’ List ambulances (filtered by role)"
echo "    GET    /ambulances/:id          â†’ Get ambulance details"
echo "    POST   /ambulances              â†’ Create ambulance"
echo ""
echo "  Patient Sessions (RBAC):"
echo "    GET    /patients/sessions       â†’ List trips (filtered by role)"
echo "    GET    /patients/sessions/:id   â†’ Get trip details"
echo "    POST   /patients/onboard        â†’ Create new trip"
echo ""
echo "  Collaborations (RBAC):"
echo "    GET    /collaborations          â†’ List partnerships (filtered)"
echo "    POST   /collaborations          â†’ Create partnership request"
echo "    PUT    /collaborations/:id      â†’ Update partnership status"
echo ""
echo "  Organizations:"
echo "    GET    /organizations           â†’ List all organizations"
echo "    GET    /organizations/:id       â†’ Get organization details"
echo ""
echo "  Dashboard:"
echo "    GET    /dashboard/stats         â†’ Get dashboard statistics"
echo ""
echo "ğŸ“Š DATABASE INFO"
echo "  Host:     localhost"
echo "  Port:     3306"
echo "  Database: resculance_db"
echo "  User:     resculance_user"
echo ""
echo "  Tables:"
echo "    â€¢ users                    (15 records)"
echo "    â€¢ organizations            (7 records)"
echo "    â€¢ ambulances              (5 records)"
echo "    â€¢ patient_sessions        (3 records)"
echo "    â€¢ collaboration_requests  (3 records)"
echo "    â€¢ patients"
echo "    â€¢ ambulance_devices"
echo "    â€¢ vital_signs"
echo "    â€¢ communications"
echo "    â€¢ audit_logs"
echo ""
echo "âœ… RBAC RULES"
echo "  Superadmin:       Sees ALL data across all organizations"
echo "  Hospital Admin:   Sees only their hospital's trips & partnerships"
echo "  Fleet Admin:      Sees only their fleet's ambulances & partnerships"
echo "  Staff:            Filtered by their organization"
echo ""
echo "ğŸ”§ TROUBLESHOOTING"
echo "  Server won't start?"
echo "    â†’ Check if port 5000 is in use: lsof -i :5000"
echo "    â†’ Check logs: tail -f server.log"
echo ""
echo "  Database errors?"
echo "    â†’ Reset and setup: make db-setup-ci"
echo "    â†’ Check connection in src/config/database.js"
echo ""
echo "  RBAC not working?"
echo "    â†’ Run tests: ./test-rbac.sh"
echo "    â†’ Check JWT token in browser DevTools"
echo ""
echo "ğŸ“ FILES TO CHECK"
echo "  Configuration:"
echo "    â€¢ src/config/database.js         â†’ DB connection"
echo "    â€¢ src/config/constants.js        â†’ App constants"
echo "    â€¢ .env                           â†’ Environment variables"
echo ""
echo "  Models (Schema-aligned):"
echo "    â€¢ src/models/PatientSession.js   â†’ âœ… Fixed (6 methods)"
echo "    â€¢ src/models/CollaborationRequest.js â†’ âœ… Fixed (5 methods)"
echo "    â€¢ src/models/User.js"
echo "    â€¢ src/models/Ambulance.js"
echo ""
echo "  Controllers (RBAC-enabled):"
echo "    â€¢ src/controllers/patientController.js       â†’ âœ… Fixed"
echo "    â€¢ src/controllers/collaborationController.js â†’ âœ… Fixed"
echo "    â€¢ src/controllers/userController.js"
echo "    â€¢ src/controllers/ambulanceController.js"
echo ""
echo "  Tests:"
echo "    â€¢ test-rbac.sh              â†’ RBAC verification (12 tests)"
echo "    â€¢ verify-data.sh            â†’ Data visibility check"
echo ""
echo "ğŸ“š DOCUMENTATION"
echo "  â€¢ PROJECT_STATUS.md                    â†’ Current status"
echo "  â€¢ RBAC_IMPLEMENTATION_COMPLETE.md      â†’ RBAC details"
echo "  â€¢ README.md                            â†’ Setup guide"
echo "  â€¢ api_document.txt                     â†’ API documentation"
echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘  Status: âœ… ALL SYSTEMS OPERATIONAL - Production Ready         â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
